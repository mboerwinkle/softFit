FIXME's
Better sort than insertion
fix variety of memory leaks and initialization errors
show peak
