FIXME's
Better sort than insertion
fix variety of memory leaks
